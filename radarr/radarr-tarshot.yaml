apiVersion: batch/v1
kind: Job
metadata:
  name: tarcopy
  namespace: radarr
spec:
  template:
    spec:
      containers:
      - name: tarcopy
        image: busybox
        command: ["sh", "-c", "cd /pvc && tar -czf /nfs/radarr-backup-$(date +%Y%m%d%H%M%S).tar.gz ."]
        volumeMounts:
        - name: pvc
          mountPath: /pvc
        - name: nfs
          mountPath: /nfs
      restartPolicy: OnFailure
      volumes:
      - name: pvc
        persistentVolumeClaim:
          claimName: radarr-config-pvc
      - name: nfs
        nfs:
          server: 192.168.0.100
          path: /mnt/backup/radarr
